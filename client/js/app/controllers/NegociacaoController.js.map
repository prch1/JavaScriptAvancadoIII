{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_ordemAtual","_service","NegociacaoService","_listaNegociacoes","Bind","ListaNegociacoes","NegociacoesView","_mensagem","Mensagem","MensagemView","_init","lista","then","negociacoes","forEach","adiciona","negociacao","catch","texto","erro","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limpaFormulario","apaga","esvazia","Negociacao","DateHelper","textoParaData","value","parseInt","parseFloat","importa","focus","coluna","inverteOrdem","orderna","a","b"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["\r\n\r\nclass  NegociacaoController{\r\n\r\n        constructor(){\r\n            let $ = document.querySelector.bind(document);\r\n            this._inputData = $('#data');\r\n            this._inputQuantidade = $('#quantidade');\r\n            this._inputValor = $('#valor');\r\n            this._ordemAtual ='';\r\n            this._service = new NegociacaoService();\r\n\r\n            this._listaNegociacoes = new Bind (new ListaNegociacoes(),\r\n                                     new  NegociacoesView($('#negociacoesView')),\r\n                                     'adiciona', 'esvazia','ordena','inverteOrdem');\r\n      \r\n            this._mensagem =new Bind( new Mensagem(),\r\n                                     new MensagemView($('#mensagemView')),\r\n                                     'texto');  \r\n\r\n            this._init();                         \r\n        }\r\n\r\n        _init(){  \r\n\r\n          this._service \r\n           .lista()\r\n           .then(negociacoes => \r\n            negociacoes.forEach(negociacao =>\r\n              this._listaNegociacoes.adiciona(negociacao)))\r\n              .catch(erro =>{\r\n                this._mensagem.texto = erro;\r\n              });\r\n         \r\n              setInterval(() => {\r\n                this.importaNegociacoes();\r\n            }, 3000);        \r\n        }\r\n\r\n    adiciona(event){   \r\n    \r\n      event.preventDefault(); \r\n\r\n       let negociacao = this._criaNegociacao();\r\n\r\n       this._service \r\n         .cadastra(negociacao)\r\n         .then(mensagem =>{\r\n             this._listaNegociacoes.adiciona(negociacao);\r\n             this._mensagem.texto = mensagem;\r\n             this._limpaFormulario();\r\n          })\r\n          .catch( erro => this._mensagem.texto = erro);                      \r\n         }\r\n\r\n         apaga() {\r\n\r\n          this._service \r\n              .apaga()\r\n              .then(mensagem => {\r\n                  this._mensagem.texto = mensagem;\r\n                  this._listaNegociacoes.esvazia();\r\n              })\r\n              .catch(erro => this._mensagem.texto = erro);\r\n      }\r\n\r\n    _criaNegociacao(){\r\n        return new Negociacao(\r\n            DateHelper.textoParaData(this._inputData.value),\r\n            parseInt(this._inputQuantidade.value),\r\n            parseFloat(this._inputValor.value));\r\n     }\r\n\r\n\r\n   importaNegociacoes(){\r\n       \r\n              this._service\r\n              .importa(this._listaNegociacoes.negociacoes)\r\n              .then(negociacoes => negociacoes.forEach(negociacao => {\r\n                   this._listaNegociacoes.adiciona(negociacao);\r\n                   this._mensagem.texto = 'Negociações do período importadas'\r\n                  }))\r\n              .catch(erro => this._mensagem.texto = erro);\r\n            \r\n        \r\n     }\r\n\r\n    _limpaFormulario()\r\n    {\r\n        this._inputData.value = '';\r\n        this._inputQuantidade.value =1;\r\n        this._inputValor.value =0.0;\r\n\r\n        this._inputData.focus();\r\n    }\r\n\r\n\r\n    orderna(coluna){\r\n\r\n      if(this._ordemAtual == coluna){\r\n        this._listaNegociacoes.inverteOrdem();\r\n      }else {\r\n        this._listaNegociacoes.orderna((a,b) => a[coluna] - b[coluna]);\r\n      }\r\n        this._ordemAtual = coluna;       \r\n    }\r\n\r\n}\r\n"]}