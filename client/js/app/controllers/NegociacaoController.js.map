{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["ListaNegociacoes","Mensagem","Negociacao","DateHelper","Bind","NegociacaoService","MensagemView","NegociacoesView","NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_ordemAtual","_service","_listaNegociacoes","_mensagem","_init","lista","then","negociacoes","forEach","adiciona","negociacao","catch","texto","erro","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limpaFormulario","apaga","esvazia","textoParaData","value","parseInt","parseFloat","importa","focus","coluna","inverteOrdem","orderna","a","b","negociacaoController","currentInstance"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import {ListaNegociacoes} from '../models/ListaNegociacoes';\r\nimport {Mensagem} from '../models/Mensagem';\r\nimport {Negociacao} from '../models/Negociacao';\r\nimport {DateHelper} from '../helpers/DateHelper';\r\nimport {Bind} from '../helpers/Bind';\r\nimport {NegociacaoService} from '../services/NegociacaoService';\r\nimport {MensagemView} from '../views/MensagemView';\r\nimport {NegociacoesView} from '../views/NegociacoesView';\r\n\r\n\r\nclass  NegociacaoController{\r\n\r\n        constructor(){\r\n            let $ = document.querySelector.bind(document);\r\n            this._inputData = $('#data');\r\n            this._inputQuantidade = $('#quantidade');\r\n            this._inputValor = $('#valor');\r\n            this._ordemAtual ='';\r\n            this._service = new NegociacaoService();\r\n\r\n            this._listaNegociacoes = new Bind (new ListaNegociacoes(),\r\n                                     new  NegociacoesView($('#negociacoesView')),\r\n                                     'adiciona', 'esvazia','ordena','inverteOrdem');\r\n      \r\n            this._mensagem =new Bind( new Mensagem(),\r\n                                     new MensagemView($('#mensagemView')),\r\n                                     'texto');  \r\n\r\n            this._init();                         \r\n        }\r\n\r\n        _init(){  \r\n\r\n          this._service \r\n           .lista()\r\n           .then(negociacoes => \r\n            negociacoes.forEach(negociacao =>\r\n              this._listaNegociacoes.adiciona(negociacao)))\r\n              .catch(erro =>{\r\n                this._mensagem.texto = erro;\r\n              });\r\n         \r\n              setInterval(() => {\r\n                this.importaNegociacoes();\r\n            }, 3000);        \r\n        }\r\n\r\n    adiciona(event){   \r\n    \r\n      event.preventDefault(); \r\n\r\n       let negociacao = this._criaNegociacao();\r\n\r\n       this._service \r\n         .cadastra(negociacao)\r\n         .then(mensagem =>{\r\n             this._listaNegociacoes.adiciona(negociacao);\r\n             this._mensagem.texto = mensagem;\r\n             this._limpaFormulario();\r\n          })\r\n          .catch( erro => this._mensagem.texto = erro);                      \r\n         }\r\n\r\n         apaga() {\r\n\r\n          this._service \r\n              .apaga()\r\n              .then(mensagem => {\r\n                  this._mensagem.texto = mensagem;\r\n                  this._listaNegociacoes.esvazia();\r\n              })\r\n              .catch(erro => this._mensagem.texto = erro);\r\n      }\r\n\r\n    _criaNegociacao(){\r\n        return new Negociacao(\r\n            DateHelper.textoParaData(this._inputData.value),\r\n            parseInt(this._inputQuantidade.value),\r\n            parseFloat(this._inputValor.value));\r\n     }\r\n\r\n\r\n   importaNegociacoes(){\r\n       \r\n              this._service\r\n              .importa(this._listaNegociacoes.negociacoes)\r\n              .then(negociacoes => negociacoes.forEach(negociacao => {\r\n                   this._listaNegociacoes.adiciona(negociacao);\r\n                   this._mensagem.texto = 'Negociações do período importadas'\r\n                  }))\r\n              .catch(erro => this._mensagem.texto = erro);\r\n            \r\n        \r\n     }\r\n\r\n    _limpaFormulario()\r\n    {\r\n        this._inputData.value = '';\r\n        this._inputQuantidade.value =1;\r\n        this._inputValor.value =0.0;\r\n\r\n        this._inputData.focus();\r\n    }\r\n\r\n\r\n    orderna(coluna){\r\n\r\n      if(this._ordemAtual == coluna){\r\n        this._listaNegociacoes.inverteOrdem();\r\n      }else {\r\n        this._listaNegociacoes.orderna((a,b) => a[coluna] - b[coluna]);\r\n      }\r\n        this._ordemAtual = coluna;       \r\n    }\r\n\r\n  }\r\n\r\nlet negociacaoController = new NegociacaoController();\r\n\r\nexport function currentInstance() {\r\n\r\n    return negociacaoController;\r\n\r\n}\r\n"]}